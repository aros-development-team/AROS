##begin config
version 41.7
libbase DOSBase
libbasetype struct DosLibrary
sysbase_field dl_SysBase
seglist_field dl_SegList
libbasetypeextern struct DosLibrary
residentpri -120
options noautolib, noexpunge
##end config
##begin cdef
#include <dos/dos.h>
#include <dos/dosextens.h>
#include <dos/record.h>
#include <dos/rdargs.h>
#include <dos/dosasl.h>
#include <dos/var.h>
#include <dos/notify.h>
#include <dos/datetime.h>
#include <dos/dostags.h>
#include <dos/exall.h>
#include <aros/preprocessor/variadic/cast2iptr.hpp>

#define AllocDosObjectTagList(...) AllocDosObject(__VA_ARGS__)
#define CreateNewProcTagList(...) CreateNewProc(__VA_ARGS__)
#define NewLoadSegTagList(...) NewLoadSeg(__VA_ARGS__)
#define System(...) SystemTagList(__VA_ARGS__)

/* Prototypes for stubs in amiga.lib */
APTR AllocDosObjectTags (ULONG type, Tag tag1, ...);
struct Process * CreateNewProcTags (Tag tag1, ...);
BPTR NewLoadSegTags (STRPTR file, Tag tag1, ...);
LONG SystemTags (STRPTR command, Tag tag1, ...);

#define FWritef(fh, format, ...) \
({ \
    IPTR __args[] = { AROS_PP_VARIADIC_CAST2IPTR(__VA_ARGS__) }; \
    VFWritef((fh), (format), __args); \
})
 
#define FPrintf(fh, format, ...) \
({ \
    IPTR __args[] = { AROS_PP_VARIADIC_CAST2IPTR(__VA_ARGS__) }; \
    VFPrintf((fh), (format), __args); \
})

#define Printf(format, ...) \
({ \
    IPTR __args[] = { AROS_PP_VARIADIC_CAST2IPTR(__VA_ARGS__) }; \
    VFPrintf(Output(), (format), __args); \
})

/* These are some aliases for functions with the same body on AROS */
#define UnLock(...) Close(__VA_ARGS__)
#define DupLockFromFH(...) DupLock(__VA_ARGS__)
#define ExamineFH(...) Examine(__VA_ARGS__)
#define NameFromFH(...) NameFromLock(__VA_ARGS__)
##end cdef
##begin cdefprivate
#include <dos/dosextens.h>
##end cdefprivate
