#   $Id$
#
#   Generate the AROS support library, libarossupport.a
#
include $(TOP)/config/make.cfg

FILES	:= \
    calcchecksum \
    clonerastport \
    createbstr \
    createrastport \
    createseglist \
    debugmem \
    deinitrastport \
    freerastport \
    freestruct \
    hexdump \
    isdosentrya \
    kprintf \
    rkprintf \
    nastyfreemem \
    purify \
    libfindtagitem \
    libgettagdata \
    libnexttagitem \
    rawputchars \
    readbyte \
    readdouble \
    readfloat \
    readlong \
    readstring \
    readstruct \
    readword \
    removeslist \
    rt \
    rt_dos \
    rt_exec \
    rt_intuition \
    strrncasecmp \
    writebyte \
    writedouble \
    writefloat \
    writelong \
    writestring \
    writestruct \
    writeword

#MM- core-linklibs : linklibs-arossupport
#MM- linklibs: linklibs-arossupport
#MM linklibs-arossupport : includes

USER_CFLAGS := -I$(SRCDIR)/rom/exec

%build_linklib mmake=linklibs-arossupport libname=arossupport files=$(FILES)

INCLUDE_FILES	    := $(call WILDCARD, include/*.h)
%copy_includes mmake=compiler-includes path=aros dir=include

#MM- compiler-includes: includes-generated-libcall_gccreg

#MM
includes-generated-libcall_gccreg: $(AROS_INCLUDES)/aros/libcall_gccreg.h $(GENINCDIR)/aros/libcall_gccreg.h

$(AROS_INCLUDES)/aros/libcall_gccreg.h: $(HOSTGENDIR)/tools/gencall_gccreg
	$(HOSTGENDIR)/tools/gencall_gccreg >$@

$(GENINCDIR)/aros/libcall_gccreg.h : $(AROS_INCLUDES)/aros/libcall_gccreg.h
	$(CP) $< $@

$(HOSTGENDIR)/tools/gencall_gccreg: $(SRCDIR)/$(CURDIR)/gencall_gccreg.c
	@$(HOST_CC) -Wall -Werror -o $@ $<
