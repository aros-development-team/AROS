####################################################################
####################################################################
############# THIS IS A GENERATED FILE ! DO NOT EDIT ###############
####################################################################
####################################################################
#   $Id$
#
#   Generate the libautoinit.a
#
include $(TOP)/config/make.cfg

LIB	:= autoinit

FILES	:= \
	arosc \
	cybergraphics \
	diskfont \
	dos \
	functions \
	graphics \
	iffparse \
	intuition \
	layers \
	libraries \
	locale \
	utility

#MM- linklibs: linklibs-autoinit
#MM linklibs-autoinit : includes

.PHONY : linklibs-autoinit linklibs-autoinit-clean linklibs-autoinit-quick
#MM
linklibs-autoinit-quick : linklibs-autoinit
#MM
linklibs-autoinit-clean : clean

ifndef OBJDIR
OBJDIR := $(GENDIR)/$(CURDIR)
endif







OBJS := $(foreach f,$(FILES),$(OBJDIR)/$(f).o)
DEPS := $(foreach f,$(FILES),$(OBJDIR)/$(f).d)

CFLAGS  := $(USER_CFLAGS) $(TARGET_CFLAGS) -I$(AROS_INCLUDES)
LDFLAGS := $(USER_LDFLAGS) $(TARGET_CFLAGS)

linklibs-$(LIB): setup $(LIBDIR)/lib$(LIB).a
	@$(NOP)

$(LIBDIR)/lib$(LIB).a : $(OBJS)
		@$(ECHO) "Creating library $@..."
	@$(AR) $@ $(OBJS)
	@$(RANLIB) $@


$(OBJDIR)/%.o : %.c
		@$(ECHO) "Compiling $(CURDIR)/$<..."
	@$(IF) $(TARGET_CC) $(CFLAGS) -c $< -o $@ > $(GENDIR)/cerrors 2>&1 ; then \
	    $(IF) $(TEST) -s $(GENDIR)/cerrors ; then \
		$(ECHO) "$(CURDIR)/$<: $(TARGET_CC) $(CFLAGS) -c $< -o $@" >> $(GENDIR)/errors ; \
		$(CAT) $(GENDIR)/cerrors >> $(GENDIR)/errors ; \
	    else \
		$(NOP) ; \
	    fi ; \
	else \
	    $(ECHO) "Compile failed: $(TARGET_CC) $(CFLAGS) -c $< -o $@" 1>&2 ; \
	    tee < $(GENDIR)/cerrors -a $(GENDIR)/errors 1>&2 ; \
	    exit 1 ; \
	fi


$(OBJDIR)/%.d : %.c
		@$(IF) [ ! -d $(@D) ]; then $(MKDIR) $(@D) ; else $(NOP) ; fi
	@$(ECHO) "Makedepend $(CURDIR)/$<..."
	@$(MKDEPEND) $(CFLAGS) $< -o $@


setup ::
		@$(FOR) dir in $(OBJDIR) $(LIBDIR) ; do \
	    $(IF) $(TEST) ! -d $$dir ; then $(MKDIR) $$dir ; else $(NOP) ; fi ; \
	done


clean ::
	-@$(RM) $(OBJDIR)


# Delete generated makefiles
clean ::
	@$(RM) $(TOP)/$(CURDIR)/mmakefile $(TOP)/$(CURDIR)/mmakefile.bak

# Include these files but only if the current target is neither
# setup nor clean.
ifeq (,$(filter clean% %clean %clean% setup% includes% ,$(TARGET)))
-include $(DEPS)
endif
