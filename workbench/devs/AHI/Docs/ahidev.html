<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from ahidev.texinfo on 27 December 2000 -->

<TITLE>Ahi Developers's Guide</TITLE>
</HEAD>
<BODY>
<H1>AHI</H1>
<H2>Hardware independent audio for Amiga</H2>
<H2>AHI Developer's Guide for AHI release </H2>
<H2>Document version </H2>
<ADDRESS>Martin 'Leviticus' Blom</ADDRESS>
<P>
<P><HR><P>
<H1>Table of Contents</H1>
<UL>
<LI><A NAME="TOC1" HREF="ahidev.html#SEC1">Overview</A>
<LI><A NAME="TOC2" HREF="ahidev.html#SEC2">Distribution</A>
<LI><A NAME="TOC3" HREF="ahidev.html#SEC3">The Author</A>
<LI><A NAME="TOC4" HREF="ahidev.html#SEC4">Definitions</A>
<LI><A NAME="TOC5" HREF="ahidev.html#SEC5">Function Interface</A>
<UL>
<LI><A NAME="TOC6" HREF="ahidev.html#SEC6">Guidelines</A>
<UL>
<LI><A NAME="TOC7" HREF="ahidev.html#SEC7">Follow The Rules</A>
<LI><A NAME="TOC8" HREF="ahidev.html#SEC8">The Library Base</A>
<LI><A NAME="TOC9" HREF="ahidev.html#SEC9">The Audio Database</A>
<LI><A NAME="TOC10" HREF="ahidev.html#SEC10">User Hooks</A>
<LI><A NAME="TOC11" HREF="ahidev.html#SEC11">Function Calls From Other Tasks, Interrupts Or User Hooks</A>
<LI><A NAME="TOC12" HREF="ahidev.html#SEC12">Multitasking</A>
</UL>
<LI><A NAME="TOC13" HREF="ahidev.html#SEC13">Opening And Closing <CODE>ahi.device</CODE> For Low-level Access</A>
<UL>
<LI><A NAME="TOC14" HREF="ahidev.html#SEC14"><CODE>Assembler</CODE></A>
<LI><A NAME="TOC15" HREF="ahidev.html#SEC15"><CODE>C</CODE></A>
</UL>
<LI><A NAME="TOC16" HREF="ahidev.html#SEC16">Obtaining The Hardware</A>
<UL>
<LI><A NAME="TOC17" HREF="ahidev.html#SEC17"><CODE>AHI_AllocAudioA()</CODE> Tags</A>
</UL>
<LI><A NAME="TOC18" HREF="ahidev.html#SEC18">Declaring Sounds</A>
<LI><A NAME="TOC19" HREF="ahidev.html#SEC19">Making Noise</A>
<UL>
<LI><A NAME="TOC20" HREF="ahidev.html#SEC20">Playing A Sound</A>
<LI><A NAME="TOC21" HREF="ahidev.html#SEC21">Playing One-shot Sounds And Advanced Loops</A>
<LI><A NAME="TOC22" HREF="ahidev.html#SEC22">Tricks With The Volume</A>
</UL>
</UL>
<LI><A NAME="TOC23" HREF="ahidev.html#SEC23">Device Interface</A>
<UL>
<LI><A NAME="TOC24" HREF="ahidev.html#SEC24">Opening And Closing <CODE>ahi.device</CODE> For High-level Access</A>
<LI><A NAME="TOC25" HREF="ahidev.html#SEC25">Reading From The Device</A>
<UL>
<LI><A NAME="TOC26" HREF="ahidev.html#SEC26">Double Buffering</A>
<LI><A NAME="TOC27" HREF="ahidev.html#SEC27">Distortion</A>
</UL>
<LI><A NAME="TOC28" HREF="ahidev.html#SEC28">Writing To The Device</A>
<UL>
<LI><A NAME="TOC29" HREF="ahidev.html#SEC29">Double Buffering</A>
<LI><A NAME="TOC30" HREF="ahidev.html#SEC30">Distortion</A>
<LI><A NAME="TOC31" HREF="ahidev.html#SEC31">Playing multiple sounds at the same time</A>
<LI><A NAME="TOC32" HREF="ahidev.html#SEC32">Suggested precedences</A>
</UL>
</UL>
<LI><A NAME="TOC33" HREF="ahidev.html#SEC33">Data Types And Structures</A>
<UL>
<LI><A NAME="TOC34" HREF="ahidev.html#SEC34">Data Types</A>
<UL>
<LI><A NAME="TOC35" HREF="ahidev.html#SEC35"><CODE>Fixed</CODE></A>
<LI><A NAME="TOC36" HREF="ahidev.html#SEC36"><CODE>sposition</CODE></A>
</UL>
<LI><A NAME="TOC37" HREF="ahidev.html#SEC37">Structures</A>
<UL>
<LI><A NAME="TOC38" HREF="ahidev.html#SEC38"><CODE>AHIUnitPrefs</CODE> And <CODE>AHIGlobalPrefs</CODE></A>
</UL>
</UL>
<LI><A NAME="TOC39" HREF="ahidev.html#SEC39">GNU GENERAL PUBLIC LICENSE</A>
<UL>
<LI><A NAME="TOC40" HREF="ahidev.html#SEC40">Preamble</A>
<LI><A NAME="TOC41" HREF="ahidev.html#SEC41">TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</A>
<LI><A NAME="TOC42" HREF="ahidev.html#SEC42">How to Apply These Terms to Your New Programs</A>
</UL>
<LI><A NAME="TOC43" HREF="ahidev.html#SEC43">GNU LIBRARY GENERAL PUBLIC LICENSE</A>
<UL>
<LI><A NAME="TOC44" HREF="ahidev.html#SEC44">Preamble</A>
<LI><A NAME="TOC45" HREF="ahidev.html#SEC45">TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</A>
<LI><A NAME="TOC46" HREF="ahidev.html#SEC46">How to Apply These Terms to Your New Libraries</A>
</UL>
<LI><A NAME="TOC47" HREF="ahidev.html#SEC47">Concept Index</A>
<LI><A NAME="TOC48" HREF="ahidev.html#SEC48">Data Type Index</A>
<LI><A NAME="TOC49" HREF="ahidev.html#SEC49">Function Index</A>
<LI><A NAME="TOC50" HREF="ahidev.html#SEC50">Variable Index</A>
</UL>
<P><HR><P>

<H1>AHI Developer's Guide</H1>

<P>
For AHI release . Document version .

</P>
<P>
Copyright (C) 1994-1999 Martin Blom

</P>
<P>
The latest release of AHI can always be found at
@url{http://www.lysator.liu.se/~lcs/ahi.html}. 

</P>



<H1><A NAME="SEC1" HREF="ahidev.html#TOC1">Overview</A></H1>

<P>
<A NAME="IDX1"></A>

</P>
<P>
This document was written in order to make it easier for developers to
understand and use AHI in their own productions, and write Software
That Works(TM).

</P>
<P>
<CODE>ahi.device</CODE> has two different API's; one library-like function
interface (low-level), and one "normal" device interface (high-level).
Each of them serves different purposes.  The low-level interface is
targeting music players, games and real-time applications. The high-level
interface is targeting applications that just want to have a sample played,
play audio streams or record samples as easily as possible.

</P>
<P>
As with everything else, it is important that you chose the right tool for
the job--you'll only get frustrated otherwise.

</P>
<P>
Not everything about AHI is documented here; for more information, see
<CITE>AHI User's Guide</CITE> and the autodocs.

</P>



<H1><A NAME="SEC2" HREF="ahidev.html#TOC2">Distribution</A></H1>

<P>
<A NAME="IDX2"></A>
<A NAME="IDX3"></A>
<A NAME="IDX4"></A>
<A NAME="IDX5"></A>
<A NAME="IDX6"></A>
<A NAME="IDX7"></A>

</P>
<P>
Copyright (C) 1994-1999 Martin Blom

</P>
<P>
AHI is available under a dual license. The device itself is under
the "GNU Library General Public License" (see section <A HREF="ahidev.html#SEC43">GNU LIBRARY GENERAL PUBLIC LICENSE</A>), while the
utility programs and the <CODE>AUDIO:</CODE> device is covered by the "GNU General
Public License" (see section <A HREF="ahidev.html#SEC39">GNU GENERAL PUBLIC LICENSE</A>).

</P>
<P>
If you use this software in a commercial or shareware product, please
consider giving the author (see section <A HREF="ahidev.html#SEC3">The Author</A>)---and preferably each one
of the contributors too (see <CITE>AHI User's Guide</CITE>)---an original or
registered copy or sample of your work.  Should you want to distribute the
AHI software with your own product, there is really nothing to
consider, right?

</P>



<H1><A NAME="SEC3" HREF="ahidev.html#TOC3">The Author</A></H1>

<P>
<A NAME="IDX8"></A>
<A NAME="IDX9"></A>

</P>
<P>
The author can be reached at the following addresses:

</P>
<DL COMPACT>

<DT>Electronic mail
<DD>
@email{martin@blom.org}

<DT>Standard mail
<DD>
  Martin Blom
<BR>Alsättersgatan 15A:24
<BR>SE-584 35 Linköping
<BR>SWEDEN

<DT>World-Wide Web
<DD>
@url{http://martin.blom.org}

</DL>



<H1><A NAME="SEC4" HREF="ahidev.html#TOC4">Definitions</A></H1>

<P>
<A NAME="IDX10"></A>

</P>
<P>
Following are some general definitions of terms that are used in this
document.

</P>
<DL COMPACT>

<DT><STRONG>Sample</STRONG>
<DD>
<A NAME="IDX11"></A>
 
A sample is one binary number, representing the amplitude at a fixed point
in time.  A sample is often stored as an 8 bit signed integer, a 16 bit
signed integer, a 32 bit floating point number etc.  AHI only
supports integers.

<A NAME="IDX12"></A>

<DT><STRONG>Sample frame</STRONG>
<DD>
In mono environments, a sample frame is the same as a sample.  In stereo
environments, a sample frame is a tuple of two samples.  The first member
is for the left channel, the second for the right.

<A NAME="IDX13"></A>

<DT><STRONG>Sound</STRONG>
<DD>
Many sample frames stored in sequence as an array can be called a sound.  A
sound is, however, not limited to being formed by samples, it can also be
parameters to an analog synth or a MIDI instrument, or be white noise.
AHI only supports sounds formed by samples.

</DL>



<H1><A NAME="SEC5" HREF="ahidev.html#TOC5">Function Interface</A></H1>

<P>
<A NAME="IDX14"></A>

</P>
<P>
 The device has, in addition to the usual I/O request protocol, a set of
functions that allows the programmer to gain full control (at least as much
as possible with device independence) over the audio hardware.  The
advantages are low overhead and much more advanced control over the playing
sounds.  The disadvantages are greater complexity and only one user per
sound card.

</P>
<P>
<A NAME="IDX15"></A>
<A NAME="IDX16"></A>
<A NAME="IDX17"></A>
<A NAME="IDX18"></A>
<A NAME="IDX19"></A>
<A NAME="IDX20"></A>

</P>
<P>
 If you want to play music or sound effects for a game, record in high
quality or want to do realtime effects, this is the API to use.

</P>



<H2><A NAME="SEC6" HREF="ahidev.html#TOC6">Guidelines</A></H2>

<P>
<A NAME="IDX21"></A>
<A NAME="IDX22"></A>

</P>



<H3><A NAME="SEC7" HREF="ahidev.html#TOC7">Follow The Rules</A></H3>

<P>
 It's really simple.  If I tell you to check return values, check sample
types when recording, not to trash d2-d7/a2-a6 in hooks, or not to call
<CODE>AHI_ControlAudio()</CODE> with the <CODE>AHIC_Play</CODE> tag from interrupts or
hooks, you do as you are told.

</P>



<H3><A NAME="SEC8" HREF="ahidev.html#TOC8">The Library Base</A></H3>

<P>
<A NAME="IDX23"></A>
<A NAME="IDX24"></A>

</P>
<P>
 The <CODE>AHIBase</CODE> structure is private, so are the sub libraries' library
base structures.  Don't try to be clever.

</P>



<H3><A NAME="SEC9" HREF="ahidev.html#TOC9">The Audio Database</A></H3>

<P>
<A NAME="IDX25"></A>

</P>
<P>
<A NAME="IDX26"></A>
<A NAME="IDX27"></A>
<A NAME="IDX28"></A>

</P>
<P>
 The implementation of the database is private, and may change any time.
<CODE>ahi.device</CODE> provides functions access the information in the database
(<CODE>AHI_NextAudioID()</CODE>, <CODE>AHI_GetAudioAttrsA()</CODE> and
<CODE>AHI_BestAudioIDA()</CODE>).

</P>



<H3><A NAME="SEC10" HREF="ahidev.html#TOC10">User Hooks</A></H3>

<P>
<A NAME="IDX29"></A>

</P>
<P>
 All user hooks must follow normal register conventions, which means that
d2-d7 and a2-a6 must be preserved.  They may be called from an interrupt,
but you cannot count on that; it can be your own process or another
process.  Don't assume the system is in single-thread mode.  Never spend
much time in a hook, get the work done as quick as possible and then
return.

</P>



<H3><A NAME="SEC11" HREF="ahidev.html#TOC11">Function Calls From Other Tasks, Interrupts Or User Hooks</A></H3>

<P>
 The <CODE>AHIAudioCtrl</CODE> structure may not be shared with other
tasks/threads.  The task that called <CODE>AHI_AllocAudioA()</CODE> must do all
other calls too (except those callable from interrupts).

</P>
<P>
 Only calls specifically said to be callable from interrupts may be called
from user hooks or interrupts.  Note that <CODE>AHI_ControlAudioA()</CODE> has
some tags that must not be present when called from an interrupt.

</P>



<H3><A NAME="SEC12" HREF="ahidev.html#TOC12">Multitasking</A></H3>

<P>
<A NAME="IDX30"></A>

</P>
<P>
 Most audio drivers need multitasking to be turned on to function properly.
Don't turn it off while using the device.

</P>



<H2><A NAME="SEC13" HREF="ahidev.html#TOC13">Opening And Closing <CODE>ahi.device</CODE> For Low-level Access</A></H2>

<P>
 Not too hard.  Just open <CODE>ahi.device</CODE> unit <CODE>AHI_NO_UNIT</CODE> and
initialize <CODE>AHIBase</CODE>.  After that you can access all the functions of
the device just as if you had opened a standard shared library.

</P>



<H3><A NAME="SEC14" HREF="ahidev.html#TOC14"><CODE>Assembler</CODE></A></H3>

<P>
 For the assembler programmer there are two handy macros: <CODE>OPENAHI</CODE>
and <CODE>CLOSEAHI</CODE>.  Here is a small example how to use them:

</P>

<PRE>
        OPENAHI 4                  ;Open at least version 4.
        lea     _AHIBase(pc),a0
        move.l  d0,(a0)
        beq     error

; AHI's functions can now be called as normal library functions:
        move.l  _AHIBase(pc),a6
        moveq   #AHI_INVALID_ID,d0
        jsr     _LVOAHI_NextAudioID(a6)

error:
        CLOSEAHI
        rts
</PRE>

<P>
 Note that you <STRONG>have</STRONG> to execute the <CODE>CLOSEAHI</CODE> macro even if
<CODE>OPENAHI</CODE> failed!

</P>



<H3><A NAME="SEC15" HREF="ahidev.html#TOC15"><CODE>C</CODE></A></H3>

<P>
 For the C programmer, here is how it should be done:

</P>
<P>

<PRE>
struct Library    *AHIBase;
struct MsgPort    *AHImp=NULL;
struct AHIRequest *AHIio=NULL;
BYTE               AHIDevice=-1;

if(AHImp = CreateMsgPort())
{
  if(AHIio = (struct AHIRequest *) CreateIORequest(
      AHImp, sizeof(struct AHIRequest)))
  {
    AHIio-&#62;ahir_Version = 4;  /* Open at least version 4. */
    if(!(AHIDevice = OpenDevice(AHINAME, AHI_NO_UNIT,
        (struct IORequest *) AHIio, NULL)))
    {
      AHIBase = (struct Library *) AHIio-&#62;ahir_Std.io_Device;

// AHI's functions can now be called as normal library functions:
      AHI_NextAudioID(AHI_INVALID_ID);

      CloseDevice((struct IORequest *) AHIio);
      AHIDevice = -1;
    }
    DeleteIORequest((struct IORequest *) AHIio);
    AHIio = NULL;
  }
  DeleteMsgPort(AHImp);
  AHImp = NULL;
}
</PRE>



<H2><A NAME="SEC16" HREF="ahidev.html#TOC16">Obtaining The Hardware</A></H2>

<P>
 If you wish to call any other function than

</P>

<UL>

<LI>

<CODE>AHI_AllocAudioRequestA()</CODE>

<LI>

<CODE>AHI_AudioRequestA()</CODE>

<LI>

<CODE>AHI_BestAudioIDA()</CODE>

<LI>

<CODE>AHI_FreeAudioRequest()</CODE>

<LI>

<CODE>AHI_GetAudioAttrsA()</CODE>

<LI>

<CODE>AHI_NextAudioID()</CODE>

<LI>

<CODE>AHI_SampleFrameSize()</CODE>

</UL>

<P>
<A NAME="IDX31"></A>
<A NAME="IDX32"></A>
<A NAME="IDX33"></A>

</P>
<P>
...you have to allocate the actual sound hardware.  This is done with
<CODE>AHI_AllocAudioA()</CODE>.  <CODE>AHI_AllocAudioA()</CODE> returns an
<CODE>AHIAudioCtrl</CODE> structure, or <CODE>NULL</CODE> if the hardware could not be
allocated.  The <CODE>AHIAudioCtrl</CODE> structure has only one public field,
<CODE>ahiac_UserData</CODE>.  This is unused by AHI and you may store
anything you like here.

</P>
<P>
 If <CODE>AHI_AllocAudioA()</CODE> fails it is important that you handle the
situation gracefully.

</P>
<P>
<A NAME="IDX34"></A>

</P>
<P>
 When you are finished playing or recording, call <CODE>AHI_FreeAudio()</CODE> to
deallocate the hardware and other resources allocated by
<CODE>AHI_AllocAudioA()</CODE>.  <CODE>AHI_FreeAudio()</CODE> also deallocates all
loaded sounds (see section <A HREF="ahidev.html#SEC18">Declaring Sounds</A>).

</P>



<H3><A NAME="SEC17" HREF="ahidev.html#TOC17"><CODE>AHI_AllocAudioA()</CODE> Tags</A></H3>

<P>
<CODE>AHI_AllocAudioA()</CODE> takes several tags as input.

</P>
<DL COMPACT>

<DT><CODE>AHIA_AudioID</CODE>
<DD>
<A NAME="IDX35"></A>
 
<A NAME="IDX36"></A>
This is the audio mode to be used.  You must not use any hardcoded values
other than <CODE>AHI_DEFAULT_ID</CODE>, which is the user's default fallback ID.
In most cases you should ask the user for an ID code (with
<CODE>AHI_AudioRequestA()</CODE>) and then store the value in your settings file.

<A NAME="IDX37"></A>

<DT><CODE>AHIA_MixFreq</CODE>
<DD>
<A NAME="IDX38"></A>
This is the mixing frequency to be used.  The actual frequency will be
rounded to the nearest frequency supported by the sound hardware.  To find
the actual frequency, use <CODE>AHI_GetAudioAttrsA()</CODE>.  If omitted or
<CODE>AHI_DEFAULT_FREQ</CODE>, the user's preferred fallback frequency will be
used.  In most cases you should ask the user for a frequency (with
<CODE>AHI_AudioRequestA()</CODE>) and then store the value in your settings file.

<DT><CODE>AHIA_Channels</CODE>
<DD>
<A NAME="IDX39"></A>
All sounds are played on a <STRONG>channel</STRONG>, and this tag selects how many you
wish to use.  In general it takes more CPU power the more channels you use
and the volume gets lower and lower.

<DT><CODE>AHIA_Sounds</CODE>
<DD>
<A NAME="IDX40"></A>
You must tell AHI how many different sounds you are going to play.
See section <A HREF="ahidev.html#SEC18">Declaring Sounds</A> for more information.

<A NAME="IDX41"></A>
<A NAME="IDX42"></A>

<DT><CODE>AHIA_SoundFunc</CODE>
<DD>
<A NAME="IDX43"></A>
With this tag you tell AHI to call a hook when a sound has been
started.  It works just like Paula's audio interrupts.  The hook receives an
<CODE>AHISoundMessage</CODE> structure as message.
<CODE>AHISoundMessage-&#62;ahism_Channel</CODE> indicates which channel the sound
that caused the hook to be called is played on.

<DT><CODE>AHIA_PlayerFunc</CODE>
<DD>
<A NAME="IDX44"></A>
If you are going to play a musical score, you should use this "interrupt"
source instead of VBLANK or CIA timers in order to get the best result with
all audio drivers.  If you cannot use this, you must not use any
"non-realtime" modes (see <CODE>AHI_GetAudioAttrsA()</CODE> in the autodocs,
the <CODE>AHIDB_Realtime</CODE> tag).

<DT><CODE>AHIA_PlayerFreq</CODE>
<DD>
<A NAME="IDX45"></A>
If non-zero, it enables timing and specifies how many times per second
<CODE>PlayerFunc</CODE> will be called.  This must be specified if
<CODE>AHIA_PlayerFunc</CODE> is!  It is suggested that you keep the frequency
below 100-200 Hz.  Since the frequency is a fixpoint number
<CODE>AHIA_PlayerFreq</CODE> should be less than 13107200 (that's 200 Hz).

<DT><CODE>AHIA_MinPlayerFreq</CODE>
<DD>
<A NAME="IDX46"></A>
The minimum frequency (<CODE>AHIA_PlayerFreq</CODE>) you will use.  You should
always supply this if you are using the device's interrupt feature!

<DT><CODE>AHIA_MaxPlayerFreq</CODE>
<DD>
<A NAME="IDX47"></A>
The maximum frequency (<CODE>AHIA_PlayerFreq</CODE>) you will use.  You should
always supply this if you are using the device's interrupt feature!

<DT><CODE>AHIA_RecordFunc</CODE>
<DD>
<A NAME="IDX48"></A>
This hook will be called regularly when sampling is turned on (see
<CODE>AHI_ControlAudioA()</CODE>).  It is important that you always check the
format of the sampled data, and ignore it if you can't parse it.  Since
this hook may be called from an interrupt, it is not legal to directly
<CODE>Write()</CODE> the buffer to disk.  To record directly to harddisk you
have to copy the samples to another buffer and signal a process to save it.
To find out the required size of the buffer, see
<CODE>AHI_GetAudioAttrsA()</CODE> in the autodocs, the
<CODE>AHIDB_MaxRecordSamples</CODE> tag.

<A NAME="IDX49"></A>

<DT><CODE>AHIA_UserData</CODE>
<DD>
<A NAME="IDX50"></A>
Can be used to initialize the <CODE>ahiac_UserData</CODE> field.  You do not have
to use this tag to change <CODE>ahiac_UserData</CODE>, you may write to it
directly.

</DL>



<H2><A NAME="SEC18" HREF="ahidev.html#TOC18">Declaring Sounds</A></H2>

<P>
<A NAME="IDX51"></A>
<A NAME="IDX52"></A>

</P>
<P>
<A NAME="IDX53"></A>

</P>
<P>
Before you can play a sample array, you must <CODE>AHI_LoadSound()</CODE> it.
Why?  Because if AHI knows what kind of sounds that will be played
later, tables and stuff can be set up in advance.  Some drivers may even
upload the samples to the sound cards local RAM and play all samples from
there, drastically reducing CPU and bus load.

</P>
<P>
You should <CODE>AHI_LoadSound()</CODE> the most important sounds first, since
the sound cards RAM may not be large enough to hold all your sounds.

</P>
<P>
<CODE>AHI_LoadSound()</CODE> also associates each sound or sample array with a
number, which is later used to refer to that particular sound.

</P>
<P>
 There are 2 types of sounds, namely <CODE>AHIST_SAMPLE</CODE> and
<CODE>AHIST_DYNAMICSAMPLE</CODE>.

</P>

<DL COMPACT>

<DT><CODE>AHIST_SAMPLE</CODE>
<DD>
<A NAME="IDX54"></A>
This is used for static samples.  Most sounds that will be played are of
this type.  Once the samples have been "loaded", you may not alter the
memory where the samples are located.  You may, however, read from it.

<DT><CODE>AHIST_DYNAMICSAMPLE</CODE>
<DD>
<A NAME="IDX55"></A>
If you wish to play samples that you calculate in realtime, or load in
portions from disk, you must use this type.  These samples will never be
uploaded to a sound cards local RAM, but always played from the normal
memory.  There is a catch, however.  Because of the fact that the sound is
mixed in chunks, you must have a certain number of samples in memory before
you start a sound of this type.  To calculate the size of the buffer (in
samples), use the following formula:


<PRE>
@math{size = samples * Fs / Fm}
</PRE>

where samples is the value returned from <CODE>AHI_GetAudioAttrsA()</CODE> when
called with the <CODE>AHIDB_MaxPlaySamples</CODE> tag, Fs is the highest
frequency the sound will be played at and Fm is the actual mixing frequency
(<CODE>AHI_ControlAudioA()/AHIC_MixFreq_Query</CODE>).

</DL>

<P>
The samples can be in one of four different formats, named <CODE>AHIST_M8S</CODE>,
<CODE>AHIST_S8S</CODE>, <CODE>AHIST_M16S</CODE>, and <CODE>AHIST_S16S</CODE>.

</P>
<DL COMPACT>

<DT><CODE>AHIST_M8S</CODE>
<DD>
<A NAME="IDX56"></A>
This is an 8 bit mono sound. Each sample frame is just one signed byte.

<DT><CODE>AHIST_S8S</CODE>
<DD>
<A NAME="IDX57"></A>
This is an 8 bit stereo sound. Each sample frame is one signed byte representing
the left channel, followed by another one for the right channel.

<DT><CODE>AHIST_M16S</CODE>
<DD>
<A NAME="IDX58"></A>
This is a 16 bit mono sound.  Each sample frame is just one signed 16 bit
word, in big endian/network order format (most significant byte first).

<DT><CODE>AHIST_S16S</CODE>
<DD>
<A NAME="IDX59"></A>
This is a 16 bit stereo sound.  Each sample frame is one signed 16 bit
word, in big endian/network order format (most significant byte first)
representing the left channel, followed by another one for the right
channel.

</DL>

<P>
<A NAME="IDX60"></A>

</P>
<P>
 If you know that you won't use a sound anymore, call
<CODE>AHI_UnloadSound()</CODE>.  <CODE>AHI_FreeAudio()</CODE> will also do that for you
for any sounds left when called.

</P>
<P>
 There is no need to place a sample array in <STRONG>Chip memory</STRONG>, but it
<STRONG>must not</STRONG> be swapped out!  Allocate your sample memory with the
<CODE>MEMF_PUBLIC</CODE> flag set.  If you wish to have your samples in virtual
memory, you have to write a double-buffer routine that copies a chunk of
memory to a <CODE>MEMF_PUBLIC</CODE> buffer.  The <STRONG>SoundFunc</STRONG> should signal a
task to do the transfer, since it may run in supervisor mode (see
<CODE>AHI_AllocAudioA()</CODE>).

</P>



<H2><A NAME="SEC19" HREF="ahidev.html#TOC19">Making Noise</A></H2>

<P>
<A NAME="IDX61"></A>
<A NAME="IDX62"></A>

</P>
<P>
After you have allocated the sound hardware and declared all your sounds,
you're ready to start playback.  This is done with a call to
<CODE>AHI_ControlAudioA()</CODE>, with the <CODE>AHIC_Play</CODE> tag set to
<CODE>TRUE</CODE>.  When this function returns the <STRONG>PlayerFunc</STRONG> (see
<CODE>AHI_AllocAudioA()</CODE>) is active, and the audio driver is feeding
silence to the sound hardware.

</P>


<H3><A NAME="SEC20" HREF="ahidev.html#TOC20">Playing A Sound</A></H3>

<P>
<A NAME="IDX63"></A>
<A NAME="IDX64"></A>
<A NAME="IDX65"></A>

</P>
<P>
All you have to do now is to set the desired sound, it's frequency and
volume.  This is done with <CODE>AHI_SetSound()</CODE>, <CODE>AHI_SetFreq()</CODE> and
<CODE>AHI_SetVol()</CODE>.  Make sure the <CODE>AHISF_IMM</CODE> flag is set for all
these function's <VAR>flag</VAR> argument.  And don't try to modify a channel
that is out of range!  If you have allocated 4 channels you may only modify
channels 0-3.

</P>
<P>
The sound will not start until both <CODE>AHI_SetSound()</CODE> and
<CODE>AHI_SetFreq()</CODE> have been called.  The sound will play even if
<CODE>AHI_SetVol()</CODE> was not called, but it will play completely silent.  If
you wish to temporary stop a sound, set its frequency to 0.  When you
change the frequency again, the sound will continue where it was.

</P>
<P>
<A NAME="IDX66"></A>

</P>
<P>
When the sound has been started it will play to the end and then repeat.
In order to play a one-shot sound you have use the <CODE>AHI_PlayA()</CODE>
function, or install a sound interrupt using the <CODE>AHIA_SoundFunc</CODE> tag
with <CODE>AHI_AllocAudioA()</CODE>.  For more information about using sound
interrupts, see below.

</P>
<P>
A little note regarding <CODE>AHI_SetSound()</CODE>:  <VAR>Offset</VAR> is the first
sample frame that will be played, both when playing backwards and forwards.
This means that if you call <CODE>AHI_SetSound()</CODE> with <VAR>offset</VAR> 0 and
<VAR>length</VAR> 4, sample fram 0, 1, 2 and 3 will be played.  If you call
<CODE>AHI_SetSound()</CODE> with <VAR>offset</VAR> 3 and <VAR>length</VAR> -4,
sample frame 3, 2, 1 and 0 will be played.

</P>
<P>
Also note that playing very short sounds will be very CPU intensive, since
there are many tasks that must be done each time a sound has reached its
end (like starting the next one, calling the <STRONG>SoundFunc</STRONG>, etc.).
Therefore, it is recommended that you "unroll" short sounds a couple of
times before you play them.  How many times you should unroll?  Well, it
depends on the situation, of course, but try making the sound a thousand
samples long if you can. Naturally, if you need your <STRONG>SoundFunc</STRONG> to
be called, you cannot unroll.

</P>


<H3><A NAME="SEC21" HREF="ahidev.html#TOC21">Playing One-shot Sounds And Advanced Loops</A></H3>

<P>
<A NAME="IDX67"></A>

</P>
<P>
 In version 4, some changes have been made since earlier releases.
One-shot sounds and sounds with only one loop segment can now be played
without using sample interrupts.  This is possible because one of the
restrictions regarding the <CODE>AHISF_IMM</CODE> flag has been removed.

</P>
<P>
 The <CODE>AHISF_IMM</CODE> flag determines if <CODE>AHI_SetSound()</CODE>,
<CODE>AHI_SetFreq()</CODE> and <CODE>AHI_SetVol()</CODE> should take effect immediately
or when the current sound has reached its end.  The rules for this flags
are:

</P>

<UL>

<LI>

If used inside a sample interrupt (<STRONG>SoundFunc</STRONG>):  Must be cleared.

<LI>

If used inside a player interrupt (<STRONG>PlayerFunc</STRONG>):  May be set or
cleared.

<LI>

If used elsewhere:  Must be set.

</UL>

<P>
 What does this mean?  It means that if all you want to do is to play a
one-shot sound from inside a <STRONG>PlayerFunc</STRONG>, you can do that by first
calling <CODE>AHI_SetSound()</CODE>, <CODE>AHI_SetFreq()</CODE> and <CODE>AHI_SetVol()</CODE>
with <CODE>AHISF_IMM</CODE> set, and then use <CODE>AHI_SetSound(ch, AHI_NOSOUND,
0, 0, actrl, 0L)</CODE> to stop the sound when it has reached the end.  You can
also set one loop segment this way.

</P>
<P>
 <CODE>AHI_PlayA()</CODE> was added in AHI version 4, and combines
<CODE>AHI_SetSound()</CODE>, <CODE>AHI_SetFreq()</CODE> and <CODE>AHI_SetVol()</CODE> into
one tag-based function.  It also allows you to set one loop and play
one-shot sounds.

</P>
<P>
 To play a sound with more than one loop segment or ping-pong looping, a
sample interrupt needs to be used.  AHI's <STRONG>SoundFunc</STRONG> works like Paula's
interrupts and is very easy to use.

</P>
<P>
 The <STRONG>SoundFunc</STRONG> hook will be called with an <CODE>AHIAudioCtrl</CODE>
structure as object and an <CODE>AHISoundMessage</CODE> structure as message.
<CODE>ahism_Channel</CODE> indicates which channel caused the hook to be called.

</P>
<P>
 An example <STRONG>SoundFunc</STRONG> which handles the repeat part of an instrument
can look like this (SAS/C code):

</P>

<PRE>
__asm __saveds ULONG SoundFunc(register __a0 struct Hook *hook,
    register __a2 struct AHIAudioCtrl *actrl,
    register __a1 struct AHISoundMessage *chan)
{
  if(ChannelDatas[chan-&#62;ahism_Channel].Length)
    AHI_SetSound(chan-&#62;ahism_Channel, 0,
        (ULONG) ChannelDatas[chan-&#62;ahism_Channel].Address,
        ChannelDatas[chan-&#62;ahism_Channel].Length,
        actrl, NULL);
  else
    AHI_SetSound(chan-&#62;ahism_Channel, AHI_NOSOUND,
        NULL, NULL, actrl, NULL);
  return NULL;
}
</PRE>

<P>
 This example is from an old version of the AHI NotePlayer for
<STRONG>DeliTracker 2</STRONG>.  <CODE>ChannelDatas</CODE> is an array where the start and
length of the repeat part is stored.  Here, a repeat length of zero
indicates a one-shot sound.  Note that this particular example only uses
one sound (0).  For applications using multiple sounds, the sound number
would have to be stored in the array as well.

</P>
<P>
 Once again, note that the <CODE>AHISF_IMM</CODE> flag should <STRONG>never</STRONG> be
set in a <STRONG>SoundFunc</STRONG> hook!

</P>



<H3><A NAME="SEC22" HREF="ahidev.html#TOC22">Tricks With The Volume</A></H3>

<P>
<A NAME="IDX68"></A>

</P>
<P>
 Starting with V4, <CODE>AHI_SetVol()</CODE> can take both negative volume and
pan parameters.  If you set the volume to a negative value, the sample
will, if the audio mode supports it, invert each sample before playing.  If
pan is negative, the sample will be encoded to go to the surround speakers.

</P>



<H1><A NAME="SEC23" HREF="ahidev.html#TOC23">Device Interface</A></H1>

<P>
<A NAME="IDX69"></A>
<A NAME="IDX70"></A>
<A NAME="IDX71"></A>
<A NAME="IDX72"></A>
<A NAME="IDX73"></A>

</P>
<P>
 The I/O request protocol makes it very easy to play audio streams, sounds
from disk and non time-critical sound effects in a multitasking friendly
way.  Recoding is just as easy, on behalf of quality.  Several programs can
play sounds at the same time, and even record at the same time if your
hardware is full duplex.

</P>
<P>
 If you want to write a sample player, play (warning?) sounds in your
applications, play an audio stream from a CD via the SCSI/IDE bus, write a
voice command utility etc., this is the API to use.

</P>
<P>
 Note that while all the low-level functions (see section <A HREF="ahidev.html#SEC5">Function Interface</A>)
count lengths and offsets in sample frames, the device interface--like all
Amiga devices--uses bytes.

</P>



<H2><A NAME="SEC24" HREF="ahidev.html#TOC24">Opening And Closing <CODE>ahi.device</CODE> For High-level Access</A></H2>

<P>
 Four primary steps are required to open ahi.device:

</P>

<UL>

<LI>

Create a message port using <CODE>CreateMsgPort()</CODE>.  Reply messages from
the device must be directed to a message port.

<A NAME="IDX74"></A>

<LI>

Create an extended I/O request structure of type <CODE>AHIRequest</CODE> using
<CODE>CreateIORequest()</CODE>.  <CODE>CreateIORequest()</CODE> will initialize the I/O
request to point to your reply port.

<LI>

Specify which version of the device you need.  The lowest supported version
is 4.  Version 1 and 3 are obsolete, and version 2 only has the low-level
API.

<A NAME="IDX75"></A>

<LI>

Open <CODE>ahi.device</CODE> unit <CODE>AHI_DEFAULT_UNIT</CODE> or any other unit the
user has specified with, for example, a <VAR>UNIT</VAR> tooltype.  Call
<CODE>OpenDevice()</CODE>, passing the I/O request.

</UL>

<P>
 Each <CODE>OpenDevice()</CODE> must eventually be matched by a call to
<CODE>CloseDevice()</CODE>.  When the last close is performed, the device will
deallocate all resources.

</P>
<P>
 All I/O requests must be completed before <CODE>CloseDevice()</CODE>.  Abort any
pending requests with <CODE>AbortIO()</CODE>.

</P>
<P>
 Example:

</P>

<PRE>
struct MsgPort    *AHImp      = NULL;
struct AHIRequest *AHIio      = NULL;
BYTE               AHIDevice  = -1;
UBYTE              unit       = AHI_DEFAULT_UNIT;

/* Check if user wants another unit here... */

if(AHImp = CreateMsgPort())
{
  if(AHIio = (struct AHIRequest *)
      CreateIORequest(AHImp, sizeof(struct AHIRequest)))
  {
    AHIio-&#62;ahir_Version = 4;
    if(!(AHIDevice = OpenDevice(AHINAME, unit, 
        (struct IORequest *) AHIio, NULL)))
    {

      /* Send commands to the device here... */

      if(! CheckIO((struct IORequest *) AHIio))
      {
        AbortIO((struct IORequest *) AHIio);
      }

      WaitIO((struct IORequest *) AHIio);

      CloseDevice((struct IORequest *) AHIio);
      AHIDevice = -1;
    }
    DeleteIORequest((struct IORequest *) AHIio);
    AHIio = NULL;
  }
  DeleteMsgPort(AHImp);
  AHImp = NULL;
}
</PRE>



<H2><A NAME="SEC25" HREF="ahidev.html#TOC25">Reading From The Device</A></H2>

<P>
<A NAME="IDX76"></A>
<A NAME="IDX77"></A>

</P>
<P>
<A NAME="IDX78"></A>
<A NAME="IDX79"></A>
<A NAME="IDX80"></A>
<A NAME="IDX81"></A>
<A NAME="IDX82"></A>
<A NAME="IDX83"></A>
<A NAME="IDX84"></A>
<A NAME="IDX85"></A>

</P>
<P>
 You read from <CODE>ahi.device</CODE> by passing an <CODE>AHIRequest</CODE> to the
device with <CODE>CMD_READ</CODE> set in <CODE>io_Command</CODE>, the number of bytes
to be read set in <CODE>io_Length</CODE>, the address of the read buffer set in
<CODE>io_Data</CODE>, the desired sample format set in <CODE>ahir_Type</CODE> and the
desired sample frequency set in <CODE>ahir_Frequency</CODE>.  The first read
command in a sequence should also have <CODE>io_Offset</CODE> set to 0.
<CODE>io_Length</CODE> must be an even multiple of the sample frame size.

</P>


<H3><A NAME="SEC26" HREF="ahidev.html#TOC26">Double Buffering</A></H3>

<P>
<A NAME="IDX86"></A>

</P>
<P>
 To do double buffering, just fill the first buffer with <CODE>DoIO()</CODE> and
<CODE>io_Offset</CODE> set to 0, then start filling the second buffer with
<CODE>SendIO()</CODE> using the same I/O request (but don't clear
<CODE>io_Offset</CODE>!).  After you have processed the first buffer, wait until
the I/O request is finished and start over with <CODE>SendIO()</CODE> on the
first buffer.

</P>


<H3><A NAME="SEC27" HREF="ahidev.html#TOC27">Distortion</A></H3>

<P>
<A NAME="IDX87"></A>

</P>
<P>
 The samples will automatically be converted to the sample format set in
<CODE>ahir_Type</CODE> and to the sample frequency set in <CODE>ahir_Frequency</CODE>.
Because it is quite unlikely that you ask for the same sample frequency the
user has chosen in the preference program, chances that the quality is
lower than expected are pretty high.  The worst problem is probably the
anti-aliasing filter before the A/D converter.  If the user has selected a
higher sampling/mixing frequency than you request, the signal will be
distorted according to the Nyquist sampling theorem.  If, on the other
hand, the user has selected a lower sampling/mixing frequency than you
request, the signal will not be distorted but rather bandlimited more than
necessary.

</P>



<H2><A NAME="SEC28" HREF="ahidev.html#TOC28">Writing To The Device</A></H2>

<P>
<A NAME="IDX88"></A>
<A NAME="IDX89"></A>

</P>
<P>
<A NAME="IDX90"></A>
<A NAME="IDX91"></A>
<A NAME="IDX92"></A>
<A NAME="IDX93"></A>
<A NAME="IDX94"></A>
<A NAME="IDX95"></A>
<A NAME="IDX96"></A>
<A NAME="IDX97"></A>
<A NAME="IDX98"></A>
<A NAME="IDX99"></A>
<A NAME="IDX100"></A>

</P>

<P>
 You write to the device by passing an <CODE>AHIRequest</CODE> to the device with
<CODE>CMD_WRITE</CODE> set in <CODE>io_Command</CODE>, the precedence in
<CODE>io_Message.mn_Node.ln_Pri</CODE>, the number of bytes to be written in
<CODE>io_Length</CODE>, the address of the write buffer set in <CODE>io_Data</CODE>,
the sample format set in <CODE>ahir_Type</CODE>, the desired sample frequency set
in <CODE>ahir_Frequency</CODE>, the desired volume set in <CODE>ahir_Volume</CODE> and
the desired stereo position set in <CODE>ahir_Position</CODE>.  Unless you are
doing double buffering, <CODE>ahir_Link</CODE> should be set to <CODE>NULL</CODE>.
<CODE>io_Length</CODE> must be an even multiple of the sample frame size.

</P>


<H3><A NAME="SEC29" HREF="ahidev.html#TOC29">Double Buffering</A></H3>

<P>
<A NAME="IDX101"></A>

</P>
<P>
 To do double buffering, you need two I/O requests.  Create the second one
by making a copy of the request you used in <CODE>OpenDevice()</CODE>.  Start the
first with <CODE>SendIO()</CODE>.  Set <CODE>ahir_Link</CODE> in the second request to
the address of the first request, and <CODE>SendIO()</CODE> it.  Wait on the
first, fill the first buffer again and repeat, this time with
<CODE>ahir_Link</CODE> of the first buffer set to the address of the second I/O
request.

</P>


<H3><A NAME="SEC30" HREF="ahidev.html#TOC30">Distortion</A></H3>

<P>
<A NAME="IDX102"></A>

</P>
<P>
 The problems with aliasing are present but not as obvious as with reading.
Just make sure your source data is bandlimited correctly, and do not play
samples at a lower frequency than they were recorded.

</P>


<H3><A NAME="SEC31" HREF="ahidev.html#TOC31">Playing multiple sounds at the same time</A></H3>

<P>
 If you want to play several sounds at the same time, just make a new copy
of the I/O request you used in <CODE>OpenDevice()</CODE>, and <CODE>CMD_WRITE</CODE>
it.  The user has set the number of channels available in the preference
tool, and if too many requests are sent to the device the one with lowest
precedence will be muted.  When a request is finished, the muted request
with the highest precedence will be played.  Note that all muted requests
continue to play silently, so the programmer will not have to worry if
there are enough channels or not.

</P>


<H3><A NAME="SEC32" HREF="ahidev.html#TOC32">Suggested precedences</A></H3>

<P>
<A NAME="IDX103"></A>

</P>
<P>
 The precedences to use depend on what kind of sound you are playing.  The
recommended precedences are the same as for <CODE>audio.device</CODE>, listed in
<CITE>AMIGA ROM Kernel Reference manual -- Devices</CITE>.  Reprinted without
permission.  So sue me.

</P>

<PRE>
 Precedences  | Type of sound
 -------------+----------------------------------------------------------
    127       |  Unstoppable.  Sounds first allocated at lower
              | precedencies, then set to this highest level.
    90 - 100  |  Emergencies.  Alert, urgent situation that requires
              | immediate action.
    80 - 90   |  Annunciators.  Attention, bell (CTRL-G).
    75        |  Speech.  Synthesized or recorded speech
              | (narrator.device).
    50 - 70   |  Sonic cues.  Sounds that provide information that is not
              | provided by graphics.  Only the beginning of of each sound
              | should be at this level; the rest should ne set to sound
              | effects level.
   -50 - 50   |  Music program.  Musical notes in a music-oriented program.
              | The higher levels should be used for the attack portions
              | of each note.
   -70 - -50  |  Sound effects.  Sounds used in conjunction with graphics.
              | More important sounds should use higher levels.
   -100 - -80 |  Background.  Theme music and restartable background sounds.
   -128       |  Silence.  Lowest level (freeing the channel completely is
              | preferred).
</PRE>

<P>
 Right.  As you can see, some things do not apply to <CODE>ahi.device</CODE>.
First, there is no way to change the precedence of a playing sound, so the
precedences should be set from the beginning.  Second, it is not
recommended to use the device interface to play music.  However, playing an
audio stream from CD or disk comes very close.  Third, there are no channels
to free in AHI since they are dynamically allocated by the device.

</P>



<H1><A NAME="SEC33" HREF="ahidev.html#TOC33">Data Types And Structures</A></H1>

<P>
<A NAME="IDX104"></A>

</P>
<P>
 In this chapter some of the data types and structures used will be
explained.  For more information, please consult the autodocs and the
include files.

</P>



<H2><A NAME="SEC34" HREF="ahidev.html#TOC34">Data Types</A></H2>

<P>
<A NAME="IDX105"></A>

</P>


<H3><A NAME="SEC35" HREF="ahidev.html#TOC35"><CODE>Fixed</CODE></A></H3>

<P>
<A NAME="IDX106"></A>

</P>
<P>
 <CODE>Fixed</CODE> is a signed long integer.  It is used to represent decimal
numbers without using floating point arithmetics.  The decimal point is
assumed to be in the middle of the 32 bit integer, thus giving 16 bits for
the integer part of the number and 16 bits for the fraction.  The largest
number that can be stored in a <CODE>Fixed</CODE> is +32767.999984741, and the
lowest number is -32768.

</P>
<P>
 Example:

</P>

<PRE>
 Decimal | Fixed
 --------+----------
  1.0    | 0x00010000
  0.5    | 0x00008000
  0.25   | 0x00004000
  0      | 0x00000000
 -0.25   | 0xffffc000
 -0.5    | 0xffff8000
 -1.0    | 0xffff0000
</PRE>



<H3><A NAME="SEC36" HREF="ahidev.html#TOC36"><CODE>sposition</CODE></A></H3>

<P>
<A NAME="IDX107"></A>

</P>
<P>
 <CODE>sposition</CODE> (stereo position) is a <CODE>Fixed</CODE>, and is used to
represent the stereo position of a sound.  0 is far left, 0.5 is center and
1.0 is far right.

</P>



<H2><A NAME="SEC37" HREF="ahidev.html#TOC37">Structures</A></H2>

<P>
<A NAME="IDX108"></A>

</P>


<H3><A NAME="SEC38" HREF="ahidev.html#TOC38"><CODE>AHIUnitPrefs</CODE> And <CODE>AHIGlobalPrefs</CODE></A></H3>

<P>
<A NAME="IDX109"></A>
<A NAME="IDX110"></A>

</P>
<P>
 These structures are used in the <CODE>AHIU</CODE> and <CODE>AHIG</CODE> chunks,
respective, which are part of the settings file (<TT>`ENV:Sys/ahi.prefs'</TT>),
The file is read by AHI on each call to <CODE>OpenDevice()</CODE>, just
before the audio hardware is allocated.

</P>
<P>
 <CODE>AHIUnitPrefs</CODE> specifies the audio mode and its parameters to use for
each device unit (currently 0-3 and <CODE>AHI_NO_UNIT</CODE>; unit 0 is also called
<CODE>AHI_DEFAULT_UNIT</CODE>).

</P>
<P>
 <CODE>AHIGlobalPrefs</CODE> contains some global options that can be used to
gain speed on slow CPUs, the global debug level and a protection against
CPU overload.  The debug level specifies which of the functions in AHI
should print debugging information to the serial port (the output can be
redirected to a console window or a file with tools like <STRONG>Sushi</STRONG>
<A NAME="DOCF1" HREF="ahidev.html#FOOT1">(1)</A>.}).

</P>



<H1><A NAME="SEC39" HREF="ahidev.html#TOC39">GNU GENERAL PUBLIC LICENSE</A></H1>
<P>
Version 2, June 1991

</P>

<PRE>
Copyright (C) 1989, 1991 Free Software Foundation, Inc.
59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</PRE>



<H2><A NAME="SEC40" HREF="ahidev.html#TOC40">Preamble</A></H2>

<P>
  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation's software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Library General Public License instead.)  You can apply it to
your programs, too.

</P>
<P>
  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

</P>
<P>
  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.

</P>
<P>
  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.

</P>
<P>
  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

</P>
<P>
  Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors' reputations.

</P>
<P>
  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at all.

</P>
<P>
  The precise terms and conditions for copying, distribution and
modification follow.

</P>


<H2><A NAME="SEC41" HREF="ahidev.html#TOC41">TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</A></H2>


<OL>
<LI>

This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The "Program", below,
refers to any such program or work, and a "work based on the Program"
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term "modification".)  Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.

<LI>

You may copy and distribute verbatim copies of the Program's
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.

<LI>

You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:


<OL>
<LI>

You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

<LI>

You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any
part thereof, to be licensed as a whole at no charge to all third
parties under the terms of this License.

<LI>

If the modified program normally reads commands interactively
when run, you must cause it, when started running for such
interactive use in the most ordinary way, to print or display an
announcement including an appropriate copyright notice and a
notice that there is no warranty (or else, saying that you provide
a warranty) and that users may redistribute the program under
these conditions, and telling the user how to view a copy of this
License.  (Exception: if the Program itself is interactive but
does not normally print such an announcement, your work based on
the Program is not required to print an announcement.)
</OL>

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

<LI>

You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:


<OL>
<LI>

Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections
1 and 2 above on a medium customarily used for software interchange; or,

<LI>

Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your
cost of physically performing source distribution, a complete
machine-readable copy of the corresponding source code, to be
distributed under the terms of Sections 1 and 2 above on a medium
customarily used for software interchange; or,

<LI>

Accompany it with the information you received as to the offer
to distribute corresponding source code.  (This alternative is
allowed only for noncommercial distribution and only if you
received the program in object code or executable form with such
an offer, in accord with Subsection b above.)
</OL>

The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

<LI>

You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.

<LI>

You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

<LI>

Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

<LI>

If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

<LI>

If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.

<LI>

The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and "any
later version", you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.

<LI>

If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.



<P><STRONG>NO WARRANTY</STRONG></P>

<LI>

BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.

<LI>

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.
</OL>


<H2>END OF TERMS AND CONDITIONS</H2>



<H2><A NAME="SEC42" HREF="ahidev.html#TOC42">How to Apply These Terms to Your New Programs</A></H2>

<P>
  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

</P>
<P>
  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

</P>

<PRE>
<VAR>one line to give the program's name and an idea of what it does.</VAR>
Copyright (C) 19<VAR>yy</VAR>  <VAR>name of author</VAR>

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License along
with this program; if not, write to the Free Software Foundation, Inc.,
59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
</PRE>

<P>
Also add information on how to contact you by electronic and paper mail.

</P>
<P>
If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:

</P>

<PRE>
Gnomovision version 69, Copyright (C) 19<VAR>yy</VAR> <VAR>name of author</VAR>
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details
type `show w'.  This is free software, and you are welcome
to redistribute it under certain conditions; type `show c' 
for details.
</PRE>

<P>
The hypothetical commands <SAMP>`show w'</SAMP> and <SAMP>`show c'</SAMP> should show
the appropriate parts of the General Public License.  Of course, the
commands you use may be called something other than <SAMP>`show w'</SAMP> and
<SAMP>`show c'</SAMP>; they could even be mouse-clicks or menu items--whatever
suits your program.

</P>
<P>
You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the program, if
necessary.  Here is a sample; alter the names:

</P>

<PRE>
Yoyodyne, Inc., hereby disclaims all copyright
interest in the program `Gnomovision'
(which makes passes at compilers) written 
by James Hacker.

<VAR>signature of Ty Coon</VAR>, 1 April 1989
Ty Coon, President of Vice
</PRE>

<P>
This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Library General
Public License instead of this License.

</P>



<H1><A NAME="SEC43" HREF="ahidev.html#TOC43">GNU LIBRARY GENERAL PUBLIC LICENSE</A></H1>

<P>
Version 2, June 1991

</P>

<PRE>
Copyright (C) 1991 Free Software Foundation, Inc.
675 Mass Ave, Cambridge, MA 02139, USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

[This is the first released version of the library GPL.  It is
 numbered 2 because it goes with version 2 of the ordinary GPL.]
</PRE>



<H2><A NAME="SEC44" HREF="ahidev.html#TOC44">Preamble</A></H2>

<P>
  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
Licenses are intended to guarantee your freedom to share and change
free software--to make sure the software is free for all its users.

</P>
<P>
  This license, the Library General Public License, applies to some
specially designated Free Software Foundation software, and to any
other libraries whose authors decide to use it.  You can use it for
your libraries, too.

</P>
<P>
  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

</P>
<P>
  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if
you distribute copies of the library, or if you modify it.

</P>
<P>
  For example, if you distribute copies of the library, whether gratis
or for a fee, you must give the recipients all the rights that we gave
you.  You must make sure that they, too, receive or can get the source
code.  If you link a program with the library, you must provide
complete object files to the recipients so that they can relink them
with the library, after making changes to the library and recompiling
it.  And you must show them these terms so they know their rights.

</P>
<P>
  Our method of protecting your rights has two steps: (1) copyright
the library, and (2) offer you this license which gives you legal
permission to copy, distribute and/or modify the library.

</P>
<P>
  Also, for each distributor's protection, we want to make certain
that everyone understands that there is no warranty for this free
library.  If the library is modified by someone else and passed on, we
want its recipients to know that what they have is not the original
version, so that any problems introduced by others will not reflect on
the original authors' reputations.

</P>
<P>
  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that companies distributing free
software will individually obtain patent licenses, thus in effect
transforming the program into proprietary software.  To prevent this,
we have made it clear that any patent must be licensed for everyone's
free use or not licensed at all.

</P>
<P>
  Most GNU software, including some libraries, is covered by the ordinary
GNU General Public License, which was designed for utility programs.  This
license, the GNU Library General Public License, applies to certain
designated libraries.  This license is quite different from the ordinary
one; be sure to read it in full, and don't assume that anything in it is
the same as in the ordinary license.

</P>
<P>
  The reason we have a separate public license for some libraries is that
they blur the distinction we usually make between modifying or adding to a
program and simply using it.  Linking a program with a library, without
changing the library, is in some sense simply using the library, and is
analogous to running a utility program or application program.  However, in
a textual and legal sense, the linked executable is a combined work, a
derivative of the original library, and the ordinary General Public License
treats it as such.

</P>
<P>
  Because of this blurred distinction, using the ordinary General
Public License for libraries did not effectively promote software
sharing, because most developers did not use the libraries.  We
concluded that weaker conditions might promote sharing better.

</P>
<P>
  However, unrestricted linking of non-free programs would deprive the
users of those programs of all benefit from the free status of the
libraries themselves.  This Library General Public License is intended to
permit developers of non-free programs to use free libraries, while
preserving your freedom as a user of such programs to change the free
libraries that are incorporated in them.  (We have not seen how to achieve
this as regards changes in header files, but we have achieved it as regards
changes in the actual functions of the Library.)  The hope is that this
will lead to faster development of free libraries.

</P>
<P>
  The precise terms and conditions for copying, distribution and
modification follow.  Pay close attention to the difference between a
"work based on the library" and a "work that uses the library".  The
former contains code derived from the library, while the latter only
works together with the library.

</P>
<P>
  Note that it is possible for a library to be covered by the ordinary
General Public License rather than by this special one.

</P>


<H2><A NAME="SEC45" HREF="ahidev.html#TOC45">TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</A></H2>


<OL>
<LI>

This License Agreement applies to any software library which
contains a notice placed by the copyright holder or other authorized
party saying it may be distributed under the terms of this Library
General Public License (also called "this License").  Each licensee is
addressed as "you".

  A "library" means a collection of software functions and/or data
prepared so as to be conveniently linked with application programs
(which use some of those functions and data) to form executables.

  The "Library", below, refers to any such software library or work
which has been distributed under these terms.  A "work based on the
Library" means either the Library or any derivative work under
copyright law: that is to say, a work containing the Library or a
portion of it, either verbatim or with modifications and/or translated
straightforwardly into another language.  (Hereinafter, translation is
included without limitation in the term "modification".)

  "Source code" for a work means the preferred form of the work for
making modifications to it.  For a library, complete source code means
all the source code for all modules it contains, plus any associated
interface definition files, plus the scripts used to control compilation
and installation of the library.

  Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running a program using the Library is not restricted, and output from
such a program is covered only if its contents constitute a work based
on the Library (independent of the use of the Library in a tool for
writing it).  Whether that is true depends on what the Library does
and what the program that uses the Library does.
  
<LI>

You may copy and distribute verbatim copies of the Library's
complete source code as you receive it, in any medium, provided that
you conspicuously and appropriately publish on each copy an
appropriate copyright notice and disclaimer of warranty; keep intact
all the notices that refer to this License and to the absence of any
warranty; and distribute a copy of this License along with the
Library.

  You may charge a fee for the physical act of transferring a copy,
and you may at your option offer warranty protection in exchange for a
fee.

<LI>

You may modify your copy or copies of the Library or any portion
of it, thus forming a work based on the Library, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:


<OL>
<LI>

The modified work must itself be a software library.

<LI>

You must cause the files modified to carry prominent notices
stating that you changed the files and the date of any change.

<LI>

You must cause the whole of the work to be licensed at no
charge to all third parties under the terms of this License.

<LI>

If a facility in the modified Library refers to a function or a
table of data to be supplied by an application program that uses
the facility, other than as an argument passed when the facility
is invoked, then you must make a good faith effort to ensure that,
in the event an application does not supply such function or
table, the facility still operates, and performs whatever part of
its purpose remains meaningful.

(For example, a function in a library to compute square roots has
a purpose that is entirely well-defined independent of the
application.  Therefore, Subsection 2d requires that any
application-supplied function or table used by this function must
be optional: if the application does not supply it, the square
root function must still compute square roots.)
</OL>

These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Library,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Library, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote
it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Library.

In addition, mere aggregation of another work not based on the Library
with the Library (or with a work based on the Library) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

<LI>

You may opt to apply the terms of the ordinary GNU General Public
License instead of this License to a given copy of the Library.  To do
this, you must alter all the notices that refer to this License, so
that they refer to the ordinary GNU General Public License, version 2,
instead of to this License.  (If a newer version than version 2 of the
ordinary GNU General Public License has appeared, then you can specify
that version instead if you wish.)  Do not make any other change in
these notices.

  Once this change is made in a given copy, it is irreversible for
that copy, so the ordinary GNU General Public License applies to all
subsequent copies and derivative works made from that copy.

  This option is useful when you wish to copy part of the code of
the Library into a program that is not a library.

<LI>

You may copy and distribute the Library (or a portion or
derivative of it, under Section 2) in object code or executable form
under the terms of Sections 1 and 2 above provided that you accompany
it with the complete corresponding machine-readable source code, which
must be distributed under the terms of Sections 1 and 2 above on a
medium customarily used for software interchange.

  If distribution of object code is made by offering access to copy
from a designated place, then offering equivalent access to copy the
source code from the same place satisfies the requirement to
distribute the source code, even though third parties are not
compelled to copy the source along with the object code.

<LI>

A program that contains no derivative of any portion of the
Library, but is designed to work with the Library by being compiled or
linked with it, is called a "work that uses the Library".  Such a
work, in isolation, is not a derivative work of the Library, and
therefore falls outside the scope of this License.

  However, linking a "work that uses the Library" with the Library
creates an executable that is a derivative of the Library (because it
contains portions of the Library), rather than a "work that uses the
library".  The executable is therefore covered by this License.
Section 6 states terms for distribution of such executables.

  When a "work that uses the Library" uses material from a header file
that is part of the Library, the object code for the work may be a
derivative work of the Library even though the source code is not.
Whether this is true is especially significant if the work can be
linked without the Library, or if the work is itself a library.  The
threshold for this to be true is not precisely defined by law.

  If such an object file uses only numerical parameters, data
structure layouts and accessors, and small macros and small inline
functions (ten lines or less in length), then the use of the object
file is unrestricted, regardless of whether it is legally a derivative
work.  (Executables containing this object code plus portions of the
Library will still fall under Section 6.)

  Otherwise, if the work is a derivative of the Library, you may
distribute the object code for the work under the terms of Section 6.
Any executables containing that work also fall under Section 6,
whether or not they are linked directly with the Library itself.

<LI>

As an exception to the Sections above, you may also compile or
link a "work that uses the Library" with the Library to produce a
work containing portions of the Library, and distribute that work
under terms of your choice, provided that the terms permit
modification of the work for the customer's own use and reverse
engineering for debugging such modifications.

  You must give prominent notice with each copy of the work that the
Library is used in it and that the Library and its use are covered by
this License.  You must supply a copy of this License.  If the work
during execution displays copyright notices, you must include the
copyright notice for the Library among them, as well as a reference
directing the user to the copy of this License.  Also, you must do one
of these things:


<OL>
<LI>

Accompany the work with the complete corresponding
machine-readable source code for the Library including whatever
changes were used in the work (which must be distributed under
Sections 1 and 2 above); and, if the work is an executable linked
with the Library, with the complete machine-readable "work that
uses the Library", as object code and/or source code, so that the
user can modify the Library and then relink to produce a modified
executable containing the modified Library.  (It is understood
that the user who changes the contents of definitions files in the
Library will not necessarily be able to recompile the application
to use the modified definitions.)

<LI>

Accompany the work with a written offer, valid for at
least three years, to give the same user the materials
specified in Subsection 6a, above, for a charge no more
than the cost of performing this distribution.

<LI>

If distribution of the work is made by offering access to copy
from a designated place, offer equivalent access to copy the above
specified materials from the same place.

<LI>

Verify that the user has already received a copy of these
materials or that you have already sent this user a copy.
</OL>

  For an executable, the required form of the "work that uses the
Library" must include any data and utility programs needed for
reproducing the executable from it.  However, as a special exception,
the source code distributed need not include anything that is normally
distributed (in either source or binary form) with the major
components (compiler, kernel, and so on) of the operating system on
which the executable runs, unless that component itself accompanies
the executable.

  It may happen that this requirement contradicts the license
restrictions of other proprietary libraries that do not normally
accompany the operating system.  Such a contradiction means you cannot
use both them and the Library together in an executable that you
distribute.

<LI>

You may place library facilities that are a work based on the
Library side-by-side in a single library together with other library
facilities not covered by this License, and distribute such a combined
library, provided that the separate distribution of the work based on
the Library and of the other library facilities is otherwise
permitted, and provided that you do these two things:


<OL>
<LI>

Accompany the combined library with a copy of the same work
based on the Library, uncombined with any other library
facilities.  This must be distributed under the terms of the
Sections above.

<LI>

Give prominent notice with the combined library of the fact
that part of it is a work based on the Library, and explaining
where to find the accompanying uncombined form of the same work.
</OL>

<LI>

You may not copy, modify, sublicense, link with, or distribute
the Library except as expressly provided under this License.  Any
attempt otherwise to copy, modify, sublicense, link with, or
distribute the Library is void, and will automatically terminate your
rights under this License.  However, parties who have received copies,
or rights, from you under this License will not have their licenses
terminated so long as such parties remain in full compliance.

<LI>

You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Library or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Library (or any work based on the
Library), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Library or works based on it.

<LI>

Each time you redistribute the Library (or any work based on the
Library), the recipient automatically receives a license from the
original licensor to copy, distribute, link with or modify the Library
subject to these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.

<LI>

If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Library at all.  For example, if a patent
license would not permit royalty-free redistribution of the Library by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Library.

If any portion of this section is held invalid or unenforceable under any
particular circumstance, the balance of the section is intended to apply,
and the section as a whole is intended to apply in other circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

<LI>

If the distribution and/or use of the Library is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Library under this License may add
an explicit geographical distribution limitation excluding those countries,
so that distribution is permitted only in or among countries not thus
excluded.  In such case, this License incorporates the limitation as if
written in the body of this License.

<LI>

The Free Software Foundation may publish revised and/or new
versions of the Library General Public License from time to time.
Such new versions will be similar in spirit to the present version,
but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number.  If the Library
specifies a version number of this License which applies to it and
"any later version", you have the option of following the terms and
conditions either of that version or of any later version published by
the Free Software Foundation.  If the Library does not specify a
license version number, you may choose any version ever published by
the Free Software Foundation.

<LI>

If you wish to incorporate parts of the Library into other free
programs whose distribution conditions are incompatible with these,
write to the author to ask for permission.  For software which is
copyrighted by the Free Software Foundation, write to the Free
Software Foundation; we sometimes make exceptions for this.  Our
decision will be guided by the two goals of preserving the free status
of all derivatives of our free software and of promoting the sharing
and reuse of software generally.



<P><STRONG>NO WARRANTY</STRONG></P>

<LI>

BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO
WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW.
EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR
OTHER PARTIES PROVIDE THE LIBRARY "AS IS" WITHOUT WARRANTY OF ANY
KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE
LIBRARY IS WITH YOU.  SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME
THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

<LI>

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN
WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY
AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU
FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR
CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE
LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF
SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES.
</OL>


<H2>END OF TERMS AND CONDITIONS</H2>



<H2><A NAME="SEC46" HREF="ahidev.html#TOC46">How to Apply These Terms to Your New Libraries</A></H2>

<P>
  If you develop a new library, and you want it to be of the greatest
possible use to the public, we recommend making it free software that
everyone can redistribute and change.  You can do so by permitting
redistribution under these terms (or, alternatively, under the terms of the
ordinary General Public License).

</P>
<P>
  To apply these terms, attach the following notices to the library.  It is
safest to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least the
"copyright" line and a pointer to where the full notice is found.

</P>

<PRE>
<VAR>one line to give the library's name and an idea of what it does.</VAR>
Copyright (C) <VAR>year</VAR>  <VAR>name of author</VAR>

This library is free software; you can redistribute it and/or modify it
under the terms of the GNU Library General Public License as published
by the Free Software Foundation; either version 2 of the License, or (at
your option) any later version.

This library is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Library General Public License for more details.

You should have received a copy of the GNU Library General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
</PRE>

<P>
Also add information on how to contact you by electronic and paper mail.

</P>
<P>
You should also get your employer (if you work as a programmer) or your
school, if any, to sign a "copyright disclaimer" for the library, if
necessary.  Here is a sample; alter the names:

</P>

<PRE>
Yoyodyne, Inc., hereby disclaims all copyright interest in the library
`Frob' (a library for tweaking knobs) written by James Random Hacker.

<VAR>signature of Ty Coon</VAR>, 1 April 1990
Ty Coon, President of Vice
</PRE>

<P>
That's all there is to it!

</P>



<H1><A NAME="SEC47" HREF="ahidev.html#TOC47">Concept Index</A></H1>

<P>
<A NAME="IDX111"></A>

</P>
<P>
<H2>a</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX71">Audio streams, playing</A>
<LI><A HREF="ahidev.html#IDX9">Author of AHI</A>
</DIR>
<H2>c</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX7">Copyright</A>
</DIR>
<H2>d</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX105">Data Types</A>
<LI><A HREF="ahidev.html#IDX104">Data Types And Structures</A>
<LI><A HREF="ahidev.html#IDX10">Definitions</A>
<LI><A HREF="ahidev.html#IDX3">Disclaimer</A>
<LI><A HREF="ahidev.html#IDX102">Distortion, playing</A>
<LI><A HREF="ahidev.html#IDX87">Distortion, recording</A>
<LI><A HREF="ahidev.html#IDX2">Distribution</A>
<LI><A HREF="ahidev.html#IDX86">Double Buffering, reading</A>
<LI><A HREF="ahidev.html#IDX101">Double Buffering, writing</A>
</DIR>
<H2>f</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX14">Function Interface</A>
</DIR>
<H2>g</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX17">Games, music</A>
<LI><A HREF="ahidev.html#IDX18">Games, sound effects</A>
<LI><A HREF="ahidev.html#IDX21">Guidelines</A>
</DIR>
<H2>h</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX29">Hooks</A>
</DIR>
<H2>l</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX5">Legal nonsense</A>
<LI><A HREF="ahidev.html#IDX23">Library base</A>
<LI><A HREF="ahidev.html#IDX4">License</A>
<LI><A HREF="ahidev.html#IDX51">Loading Sounds</A>
</DIR>
<H2>m</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX30">Multitasking</A>
<LI><A HREF="ahidev.html#IDX15">Music, games</A>
<LI><A HREF="ahidev.html#IDX69">Music, streams from disk</A>
</DIR>
<H2>o</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX1">Overview</A>
</DIR>
<H2>p</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX89">Playing</A>
<LI><A HREF="ahidev.html#IDX70">Playing audio streams</A>
<LI><A HREF="ahidev.html#IDX103">Precedences</A>
<LI><A HREF="ahidev.html#IDX22">Programming guidelines</A>
</DIR>
<H2>r</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX76">Reading</A>
<LI><A HREF="ahidev.html#IDX19">Realtime effects</A>
<LI><A HREF="ahidev.html#IDX77">Recording</A>
<LI><A HREF="ahidev.html#IDX20">Recording, high quality</A>
<LI><A HREF="ahidev.html#IDX73">Recording, quick and easy</A>
<LI><A HREF="ahidev.html#IDX111">Recursion</A>
</DIR>
<H2>s</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX11">Sample</A>
<LI><A HREF="ahidev.html#IDX12">Sample frame</A>
<LI><A HREF="ahidev.html#IDX6">Software license</A>
<LI><A HREF="ahidev.html#IDX13">Sound</A>
<LI><A HREF="ahidev.html#IDX16">Sound effects, games</A>
<LI><A HREF="ahidev.html#IDX72">Sound effects, system</A>
<LI><A HREF="ahidev.html#IDX108">Structures</A>
<LI><A HREF="ahidev.html#IDX68">Surround sound</A>
</DIR>
<H2>t</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX25">The Audio Database</A>
<LI><A HREF="ahidev.html#IDX8">The Author</A>
</DIR>
<H2>u</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX52">Unloading Sounds</A>
</DIR>
<H2>w</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX88">Writing</A>
</DIR>

</P>



<H1><A NAME="SEC48" HREF="ahidev.html#TOC48">Data Type Index</A></H1>

<P>
<H2>a</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX32">AHIAudioCtrl</A>
<LI><A HREF="ahidev.html#IDX24">AHIBase</A>
<LI><A HREF="ahidev.html#IDX110">AHIGlobalPrefs</A>
<LI><A HREF="ahidev.html#IDX74">AHIRequest</A>
<LI><A HREF="ahidev.html#IDX41">AHISoundMessage</A>
<LI><A HREF="ahidev.html#IDX109">AHIUnitPrefs</A>
</DIR>
<H2>f</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX106">Fixed</A>
</DIR>
<H2>s</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX107">sposition</A>
</DIR>

</P>



<H1><A NAME="SEC49" HREF="ahidev.html#TOC49">Function Index</A></H1>

<P>
<H2>a</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX31">AHI_AllocAudioA()</A>
<LI><A HREF="ahidev.html#IDX28">AHI_BestAudioIDA()</A>
<LI><A HREF="ahidev.html#IDX61">AHI_ControlAudioA()</A>
<LI><A HREF="ahidev.html#IDX34">AHI_FreeAudio()</A>
<LI><A HREF="ahidev.html#IDX27">AHI_GetAudioAttrsA()</A>
<LI><A HREF="ahidev.html#IDX53">AHI_LoadSound()</A>
<LI><A HREF="ahidev.html#IDX26">AHI_NextAudioID()</A>
<LI><A HREF="ahidev.html#IDX66">AHI_PlayA()</A>
<LI><A HREF="ahidev.html#IDX64">AHI_SetFreq()</A>
<LI><A HREF="ahidev.html#IDX63">AHI_SetSound()</A>
<LI><A HREF="ahidev.html#IDX65">AHI_SetVol()</A>
<LI><A HREF="ahidev.html#IDX60">AHI_UnloadSound()</A>
</DIR>

</P>



<H1><A NAME="SEC50" HREF="ahidev.html#TOC50">Variable Index</A></H1>

<P>
<H2>a</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX37">AHI_DEFAULT_FREQ</A>
<LI><A HREF="ahidev.html#IDX35">AHI_DEFAULT_ID</A>
<LI><A HREF="ahidev.html#IDX75">AHI_DEFAULT_UNIT</A>
<LI><A HREF="ahidev.html#IDX36">AHIA_AudioID</A>
<LI><A HREF="ahidev.html#IDX39">AHIA_Channels</A>
<LI><A HREF="ahidev.html#IDX47">AHIA_MaxPlayerFreq</A>
<LI><A HREF="ahidev.html#IDX46">AHIA_MinPlayerFreq</A>
<LI><A HREF="ahidev.html#IDX38">AHIA_MixFreq</A>
<LI><A HREF="ahidev.html#IDX45">AHIA_PlayerFreq</A>
<LI><A HREF="ahidev.html#IDX44">AHIA_PlayerFunc</A>
<LI><A HREF="ahidev.html#IDX48">AHIA_RecordFunc</A>
<LI><A HREF="ahidev.html#IDX43">AHIA_SoundFunc</A>
<LI><A HREF="ahidev.html#IDX40">AHIA_Sounds</A>
<LI><A HREF="ahidev.html#IDX50">AHIA_UserData</A>
<LI><A HREF="ahidev.html#IDX33">ahiac_UserData</A>, <A HREF="ahidev.html#IDX49">ahiac_UserData</A>
<LI><A HREF="ahidev.html#IDX62">AHIC_Play</A>
<LI><A HREF="ahidev.html#IDX83">ahir_Frequency</A>, <A HREF="ahidev.html#IDX96">ahir_Frequency</A>
<LI><A HREF="ahidev.html#IDX99">ahir_Link</A>
<LI><A HREF="ahidev.html#IDX98">ahir_Position</A>
<LI><A HREF="ahidev.html#IDX82">ahir_Type</A>, <A HREF="ahidev.html#IDX95">ahir_Type</A>
<LI><A HREF="ahidev.html#IDX97">ahir_Volume</A>
<LI><A HREF="ahidev.html#IDX67">AHISF_IMM</A>
<LI><A HREF="ahidev.html#IDX42">ahism_Channel</A>
<LI><A HREF="ahidev.html#IDX55">AHIST_DYNAMICSAMPLE</A>
<LI><A HREF="ahidev.html#IDX58">AHIST_M16S</A>
<LI><A HREF="ahidev.html#IDX56">AHIST_M8S</A>
<LI><A HREF="ahidev.html#IDX59">AHIST_S16S</A>
<LI><A HREF="ahidev.html#IDX57">AHIST_S8S</A>
<LI><A HREF="ahidev.html#IDX54">AHIST_SAMPLE</A>
</DIR>
<H2>c</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX78">CMD_READ</A>
<LI><A HREF="ahidev.html#IDX90">CMD_WRITE</A>
</DIR>
<H2>i</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX79">io_Command</A>, <A HREF="ahidev.html#IDX91">io_Command</A>
<LI><A HREF="ahidev.html#IDX81">io_Data</A>, <A HREF="ahidev.html#IDX94">io_Data</A>
<LI><A HREF="ahidev.html#IDX80">io_Length</A>, <A HREF="ahidev.html#IDX84">io_Length</A>, <A HREF="ahidev.html#IDX93">io_Length</A>, <A HREF="ahidev.html#IDX100">io_Length</A>
<LI><A HREF="ahidev.html#IDX85">io_Offset</A>
</DIR>
<H2>l</H2>
<DIR>
<LI><A HREF="ahidev.html#IDX92">ln_Pri</A>
</DIR>

</P>

<P><HR><P>
<H1>Footnotes</H1>
<H3><A NAME="FOOT1" HREF="ahidev.html#DOCF1">(1)</A></H3>
<P>Available from AmiNet, for example <BR>
@url{ftp://ftp.germany.aminet.org/pub/aminet/dev/debug/Sushi.lha
<P><HR><P>
This document was generated on 27 December 2000 using the
<A HREF="http://wwwcn.cern.ch/dci/texi2html/">texi2html</A>
translator version 1.51.</P>
</BODY>
</HTML>
