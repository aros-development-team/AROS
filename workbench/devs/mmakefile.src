# $Id$
include $(TOP)/config/make.cfg

OBJDIR := $(GENDIR)/$(CURDIR)

%define_libs

DEVS := $(DEVSDIR)/ram.handler    \
	$(DEVSDIR)/nil.handler    \
	$(DEVSDIR)/ffs.handler    \
	$(DEVSDIR)/pipe.handler   \
## 	$(DEVSDIR)/rootfs.handler \
	$(DEVSDIR)/fdsk.device    \
	$(DEVSDIR)/ramdrive.device

#MM workbench-devs : setup includes
workbench-devs : $(DEVS) $(DEVSDIR)/Mountlist
	@$(NOP)

#MM workbench-devs-quick :
workbench-devs-quick : $(DEVS) $(DEVSDIR)/Mountlist
	@$(NOP)

#MM
setup :
	%mkdirs_q $(OBJDIR) $(DEVSDIR) $(AROSDIR)/DiskImages

#MM
clean ::
	-$(RM) $(DEVSDIR) *.err

$(DEVSDIR)/Mountlist : Mountlist
	@$(CP) $< $@

$(OBJDIR)/%.o : %.c
	%compile_q

$(DEVSDIR)/%.handler : $(OBJDIR)/%_handler.o
	%link_q startup=

$(DEVSDIR)/%.device : $(OBJDIR)/%_device.o
	%link_q startup=

$(OBJDIR)/%.d : %.c
	%mkdepend_q

%common
%include_deps $(OBJDIR)/ram_handler.d $(OBJDIR)/nil_handler.d $(OBJDIR)/ffs_handler.d $(OBJDIR)/rootfs_handler.d $(OBJDIR)/fdsk_device.d
